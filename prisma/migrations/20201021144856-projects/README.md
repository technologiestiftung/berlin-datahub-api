# Migration `20201021144856-projects`

This migration has been generated by fabianmoronzirfas at 10/21/2020, 4:48:56 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Device" ADD COLUMN "projectId" integer   

CREATE TABLE "public"."Project" (
"id" SERIAL,
"description" text   NOT NULL ,
"title" text   NOT NULL ,
"city" text   ,
"ttnAppId" text   ,
"userId" integer   ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."Project" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."Device" ADD FOREIGN KEY ("projectId")REFERENCES "public"."Project"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201014144714-value-to-number..20201021144856-projects
--- datamodel.dml
+++ datamodel.dml
@@ -2,23 +2,35 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
 }
 // this is for the harvester to be able to login
 model User {
-  id        Int      @id @default(autoincrement())
-  createdAt DateTime @default(now())
-  username  String   @unique
+  id        Int       @id @default(autoincrement())
+  createdAt DateTime  @default(now())
+  username  String    @unique
   password  String
+  projects  Project[]
 }
+model Project {
+  id          Int      @id @default(autoincrement())
+  description String
+  title       String
+  city        String?
+  ttnAppId    String?
+  devices     Device[]
+  User        User?    @relation(fields: [userId], references: [id])
+  userId      Int?
+}
+
 model Device {
   id Int @id @default(autoincrement())
   ttnDeviceId String
@@ -26,13 +38,10 @@
   description String?
   records     Record[]
   latitude    Float?
   longitude   Float?
-  // possible more MetdData
-  // location
-  // SSID
-  // foo
-  // Cake
+  Project     Project? @relation(fields: [projectId], references: [id])
+  projectId   Int?
 }
 model Record {
```


